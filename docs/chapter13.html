<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tim Rößling">

<title>15&nbsp; Convolutional Neural Networks – Machine Learning and Deep Learning Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./chapter12.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter13.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Convolutional Neural Networks</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Machine Learning and Deep Learning Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">🚀 Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentals of Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Building an End-to-End Machine Learning Pipeline</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Unsupervised Learning: Clustering Techniques</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Supervised Learning: Regression and Classification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dimensionality Reduction Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tree-Based Models and Ensemble Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6v2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Support Vector Machines and Model Evaluation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Outlier Detection and Recommendation Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Gradient Descent: Optimization in Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Neural Networks and Deep Learning Foundations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Batch Normalization, RNN, Distributed Deep Learning and Tensorflow</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Variants of Recurrent Neural Networks (RNNs): LSTM, GRU, BiLSTM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Autoencoders</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Convolutional Neural Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-convolutional-neural-networks" id="toc-introduction-to-convolutional-neural-networks" class="nav-link active" data-scroll-target="#introduction-to-convolutional-neural-networks"><span class="header-section-number">15.1</span> Introduction to Convolutional Neural Networks</a>
  <ul class="collapse">
  <li><a href="#what-are-convolutional-neural-networks" id="toc-what-are-convolutional-neural-networks" class="nav-link" data-scroll-target="#what-are-convolutional-neural-networks"><span class="header-section-number">15.1.1</span> What are Convolutional Neural Networks?</a></li>
  </ul></li>
  <li><a href="#how-convolutional-neural-networks-work-key-concepts" id="toc-how-convolutional-neural-networks-work-key-concepts" class="nav-link" data-scroll-target="#how-convolutional-neural-networks-work-key-concepts"><span class="header-section-number">15.2</span> How Convolutional Neural Networks Work: Key Concepts</a>
  <ul class="collapse">
  <li><a href="#convolutional-layers-the-heart-of-a-cnn" id="toc-convolutional-layers-the-heart-of-a-cnn" class="nav-link" data-scroll-target="#convolutional-layers-the-heart-of-a-cnn"><span class="header-section-number">15.2.1</span> Convolutional Layers: The Heart of a CNN</a></li>
  <li><a href="#weight-sharing-and-partially-connected-layers" id="toc-weight-sharing-and-partially-connected-layers" class="nav-link" data-scroll-target="#weight-sharing-and-partially-connected-layers"><span class="header-section-number">15.2.2</span> Weight Sharing and Partially Connected Layers</a></li>
  <li><a href="#weight-sharing-and-partially-connected-layers-1" id="toc-weight-sharing-and-partially-connected-layers-1" class="nav-link" data-scroll-target="#weight-sharing-and-partially-connected-layers-1"><span class="header-section-number">15.2.3</span> Weight Sharing and Partially Connected Layers</a></li>
  <li><a href="#image-representation-channels-pixels-and-depth" id="toc-image-representation-channels-pixels-and-depth" class="nav-link" data-scroll-target="#image-representation-channels-pixels-and-depth"><span class="header-section-number">15.2.4</span> Image Representation: Channels, Pixels, and Depth</a></li>
  </ul></li>
  <li><a href="#building-blocks-of-cnns" id="toc-building-blocks-of-cnns" class="nav-link" data-scroll-target="#building-blocks-of-cnns"><span class="header-section-number">15.3</span> Building Blocks of CNNs</a>
  <ul class="collapse">
  <li><a href="#convolution-layer" id="toc-convolution-layer" class="nav-link" data-scroll-target="#convolution-layer"><span class="header-section-number">15.3.1</span> Convolution Layer</a></li>
  <li><a href="#pooling-layer" id="toc-pooling-layer" class="nav-link" data-scroll-target="#pooling-layer"><span class="header-section-number">15.3.2</span> Pooling Layer</a></li>
  <li><a href="#fully-connected-layer-dense-layer" id="toc-fully-connected-layer-dense-layer" class="nav-link" data-scroll-target="#fully-connected-layer-dense-layer"><span class="header-section-number">15.3.3</span> Fully Connected Layer (Dense Layer)</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">15.3.4</span> Summary</a></li>
  </ul></li>
  <li><a href="#cnn-architecture-and-layers" id="toc-cnn-architecture-and-layers" class="nav-link" data-scroll-target="#cnn-architecture-and-layers"><span class="header-section-number">15.4</span> CNN Architecture and Layers</a>
  <ul class="collapse">
  <li><a href="#layer-by-layer-breakdown" id="toc-layer-by-layer-breakdown" class="nav-link" data-scroll-target="#layer-by-layer-breakdown"><span class="header-section-number">15.4.1</span> Layer-by-Layer Breakdown</a></li>
  <li><a href="#training-cnns-forward-propagation-and-backpropagation" id="toc-training-cnns-forward-propagation-and-backpropagation" class="nav-link" data-scroll-target="#training-cnns-forward-propagation-and-backpropagation"><span class="header-section-number">15.4.2</span> Training CNNs: Forward Propagation and Backpropagation</a></li>
  <li><a href="#forward-propagation-making-predictions" id="toc-forward-propagation-making-predictions" class="nav-link" data-scroll-target="#forward-propagation-making-predictions"><span class="header-section-number">15.4.3</span> Forward Propagation: Making Predictions</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="header-section-number">15.4.4</span> Summary</a></li>
  </ul></li>
  <li><a href="#cnn-optimization-and-techniques" id="toc-cnn-optimization-and-techniques" class="nav-link" data-scroll-target="#cnn-optimization-and-techniques"><span class="header-section-number">15.5</span> CNN Optimization and Techniques</a>
  <ul class="collapse">
  <li><a href="#learning-with-cnns-strides-padding-and-filter-sizes" id="toc-learning-with-cnns-strides-padding-and-filter-sizes" class="nav-link" data-scroll-target="#learning-with-cnns-strides-padding-and-filter-sizes"><span class="header-section-number">15.5.1</span> Learning with CNNs: Strides, Padding, and Filter Sizes</a></li>
  <li><a href="#dropout-and-regularization" id="toc-dropout-and-regularization" class="nav-link" data-scroll-target="#dropout-and-regularization"><span class="header-section-number">15.5.2</span> Dropout and Regularization</a></li>
  <li><a href="#data-augmentation-in-cnns" id="toc-data-augmentation-in-cnns" class="nav-link" data-scroll-target="#data-augmentation-in-cnns"><span class="header-section-number">15.5.3</span> Data Augmentation in CNNs</a></li>
  </ul></li>
  <li><a href="#real-world-applications-of-cnns" id="toc-real-world-applications-of-cnns" class="nav-link" data-scroll-target="#real-world-applications-of-cnns"><span class="header-section-number">15.6</span> Real-World Applications of CNNs</a>
  <ul class="collapse">
  <li><a href="#image-classification" id="toc-image-classification" class="nav-link" data-scroll-target="#image-classification"><span class="header-section-number">15.6.1</span> Image Classification</a></li>
  <li><a href="#object-detection" id="toc-object-detection" class="nav-link" data-scroll-target="#object-detection"><span class="header-section-number">15.6.2</span> Object Detection</a></li>
  <li><a href="#example-applications" id="toc-example-applications" class="nav-link" data-scroll-target="#example-applications"><span class="header-section-number">15.6.3</span> Example Applications:</a></li>
  </ul></li>
  <li><a href="#conclusion-and-summary" id="toc-conclusion-and-summary" class="nav-link" data-scroll-target="#conclusion-and-summary"><span class="header-section-number">15.7</span> Conclusion and Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Convolutional Neural Networks</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tim Rößling </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-to-convolutional-neural-networks" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="introduction-to-convolutional-neural-networks"><span class="header-section-number">15.1</span> Introduction to Convolutional Neural Networks</h2>
<section id="what-are-convolutional-neural-networks" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="what-are-convolutional-neural-networks"><span class="header-section-number">15.1.1</span> What are Convolutional Neural Networks?</h3>
<p>Convolutional Neural Networks (CNNs) are a specialized class of deep neural networks primarily used for processing structured grid data, such as images. They are designed to recognize patterns directly from image data, making them incredibly effective for tasks like image classification, object detection, and even facial recognition.</p>
<section id="importance-of-cnns-in-image-recognition" class="level4" data-number="15.1.1.1">
<h4 data-number="15.1.1.1" class="anchored" data-anchor-id="importance-of-cnns-in-image-recognition"><span class="header-section-number">15.1.1.1</span> Importance of CNNs in Image Recognition</h4>
<p>CNNs are at the heart of most modern image recognition systems. Traditional machine learning techniques and simple neural networks often struggle when it comes to working with large, high-dimensional images. This is because the input data (e.g., pixels in an image) is vast, and feeding this directly into a fully connected neural network would require an enormous number of parameters, making the process computationally expensive and inefficient.</p>
<p>CNNs overcome these challenges by employing a unique structure that: - Reduces the number of parameters. - Allows the network to focus on local features of an image. - Retains important spatial relationships.</p>
<p>This structure makes CNNs ideal for tasks like: - <strong>Image Classification</strong>: Assigning a label to an image (e.g., classifying an image of a dog as “dog”). - <strong>Object Detection</strong>: Identifying and localizing objects within an image. - <strong>Semantic Segmentation</strong>: Classifying each pixel of an image into a predefined category (e.g., background, road, car).</p>
</section>
<section id="a-brief-history-and-emergence-from-the-visual-cortex" class="level4" data-number="15.1.1.2">
<h4 data-number="15.1.1.2" class="anchored" data-anchor-id="a-brief-history-and-emergence-from-the-visual-cortex"><span class="header-section-number">15.1.1.2</span> A Brief History and Emergence from the Visual Cortex</h4>
<p>CNNs are inspired by the human visual cortex. In the brain, the primary visual cortex processes images in a hierarchical fashion: - <strong>Simple cells</strong> detect low-level features such as edges. - <strong>Complex cells</strong> combine those low-level features to recognize more complex patterns like shapes and objects.</p>
<p>The architecture of CNNs mimics this biological approach, using multiple layers to progressively extract higher-level features from an image. This idea was introduced in the 1980s by Yann LeCun and his collaborators, who developed <strong>LeNet</strong>, one of the earliest CNN architectures, which was used for handwritten digit recognition. CNNs gained popularity in the 2010s with the advent of powerful GPUs, large datasets, and advances in deep learning techniques.</p>
</section>
<section id="why-traditional-neural-networks-struggle-with-large-image-recognition" class="level4" data-number="15.1.1.3">
<h4 data-number="15.1.1.3" class="anchored" data-anchor-id="why-traditional-neural-networks-struggle-with-large-image-recognition"><span class="header-section-number">15.1.1.3</span> Why Traditional Neural Networks Struggle with Large Image Recognition</h4>
<p>Traditional neural networks (fully connected networks) struggle with large images because they require each neuron to be connected to every pixel in the image. For example: - Consider an image of size 100x100 pixels. This image has 10,000 individual pixels. - If the neural network has just 1,000 neurons in the first hidden layer, it would require <strong>10 million connections</strong> for just the first layer.</p>
<p>This is not only computationally expensive but also prone to overfitting, as the network may memorize the entire image rather than learning generalized features. CNNs address these issues by leveraging their unique architecture, which focuses on local patterns and reduces the number of parameters significantly.</p>
</section>
</section>
</section>
<section id="how-convolutional-neural-networks-work-key-concepts" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="how-convolutional-neural-networks-work-key-concepts"><span class="header-section-number">15.2</span> How Convolutional Neural Networks Work: Key Concepts</h2>
<section id="convolutional-layers-the-heart-of-a-cnn" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="convolutional-layers-the-heart-of-a-cnn"><span class="header-section-number">15.2.1</span> Convolutional Layers: The Heart of a CNN</h3>
<p>Convolutional layers are the most critical part of a CNN. These layers apply convolutional operations (also known as filters or kernels) to extract features from the input image. Let’s break it down.</p>
<section id="what-is-convolution" class="level4" data-number="15.2.1.1">
<h4 data-number="15.2.1.1" class="anchored" data-anchor-id="what-is-convolution"><span class="header-section-number">15.2.1.1</span> What is Convolution?</h4>
<p>At a high level, convolution involves sliding a smaller filter (a matrix) across a larger image and computing a weighted sum of the filter and image regions. This operation produces an output called a feature map that highlights specific features in the image, such as edges, textures, or shapes.</p>
<p><strong>Intuitive Explanation</strong>:<br>
Imagine you have a magnifying glass, and you’re sliding it over a photo. As you slide the magnifying glass over each part of the image, you’re looking for specific patterns (like edges or corners). Each region you examine gets a score based on the pattern you’re looking for, and this score gets placed in a new image (feature map).</p>
<p><strong>Analogy</strong>:<br>
Think of convolution as moving a magnifying glass over a picture to focus on specific patterns, such as edges, corners, or textures. Just like how the glass zooms in on particular areas, convolution focuses on a small portion of the image, analyzing local features.</p>
</section>
<section id="python-example-convolution-operation" class="level4" data-number="15.2.1.2">
<h4 data-number="15.2.1.2" class="anchored" data-anchor-id="python-example-convolution-operation"><span class="header-section-number">15.2.1.2</span> Python Example: Convolution Operation</h4>
<p>Here’s a simple example in Python that demonstrates how a convolution operation works on an image using a 3x3 filter. We’ll use NumPy for the matrix operations.</p>
<div id="7a97df8a" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example image (5x5) matrix (grayscale)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example filter (3x3)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>filter_ <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">1</span>, <span class="op">-</span><span class="dv">4</span>, <span class="dv">1</span>],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Output matrix (feature map) after applying the convolution</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> np.zeros_like(image)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply convolution operation (valid padding, no padding)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(image.shape[<span class="dv">0</span>] <span class="op">-</span> filter_.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(image.shape[<span class="dv">1</span>] <span class="op">-</span> filter_.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the region of interest (3x3)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        region <span class="op">=</span> image[i:i <span class="op">+</span> <span class="dv">3</span>, j:j <span class="op">+</span> <span class="dv">3</span>]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Element-wise multiplication and sum</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        output[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(region <span class="op">*</span> filter_)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Convolution Output (Feature Map):"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Convolution Output (Feature Map):
[[  0  -6   6   0   0]
 [-10 -18   8   0   0]
 [  8   8   0   0   0]
 [  0   0   0   0   0]
 [  0   0   0   0   0]]</code></pre>
</div>
</div>
<p><strong>Mathematical Intuition</strong></p>
<p>Convolution is mathematically expressed as the cross-correlation between the filter and the input image. Given an image ( I ) and a filter ( F ), the output of the convolution operation at position ( (i, j) ) is defined as:</p>
<p><span class="math display">\[
(I * F)_{i,j} = \sum_{m=0}^{M-1} \sum_{n=0}^{N-1} I_{i+m,j+n} \cdot F_{m,n}
\]</span></p>
<p>Where:</p>
<ul>
<li>( M ) and ( N ) are the dimensions of the filter.</li>
<li>( I_{i+m,j+n} ) are the values in the input image at position ( (i+m, j+n) ).</li>
<li>( F_{m,n} ) are the values in the filter.</li>
</ul>
<p>This operation sums the element-wise product of the filter and the image region it overlaps with at each position.</p>
</section>
</section>
<section id="weight-sharing-and-partially-connected-layers" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="weight-sharing-and-partially-connected-layers"><span class="header-section-number">15.2.2</span> Weight Sharing and Partially Connected Layers</h3>
</section>
<section id="weight-sharing-and-partially-connected-layers-1" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="weight-sharing-and-partially-connected-layers-1"><span class="header-section-number">15.2.3</span> Weight Sharing and Partially Connected Layers</h3>
<section id="fully-connected-layers-the-challenge" class="level4" data-number="15.2.3.1">
<h4 data-number="15.2.3.1" class="anchored" data-anchor-id="fully-connected-layers-the-challenge"><span class="header-section-number">15.2.3.1</span> Fully Connected Layers: The Challenge</h4>
<p>In a standard fully connected layer, every neuron is connected to every pixel in the input image. However, this approach becomes computationally expensive as the input size grows.</p>
</section>
<section id="how-cnns-reduce-the-number-of-connections" class="level4" data-number="15.2.3.2">
<h4 data-number="15.2.3.2" class="anchored" data-anchor-id="how-cnns-reduce-the-number-of-connections"><span class="header-section-number">15.2.3.2</span> How CNNs Reduce the Number of Connections</h4>
<p>CNNs solve this problem using <strong>weight sharing</strong> and <strong>partially connected layers</strong>.</p>
<ul>
<li><strong>Weight Sharing</strong>: In CNNs, the same set of weights (i.e., the filter) is shared across the entire image. Instead of having unique weights for each pixel, the network uses the same filter to scan different regions of the image.</li>
<li><strong>Translation-Invariant Features</strong>: This approach allows the network to recognize patterns (e.g., edges) regardless of their location in the image.</li>
<li><strong>Reduced Parameters</strong>: By reusing weights, CNNs significantly reduce the number of parameters, making the model more efficient and less prone to overfitting.</li>
</ul>
</section>
<section id="example-fully-connected-vs.-partially-connected-structure" class="level4" data-number="15.2.3.3">
<h4 data-number="15.2.3.3" class="anchored" data-anchor-id="example-fully-connected-vs.-partially-connected-structure"><span class="header-section-number">15.2.3.3</span> Example: Fully Connected vs.&nbsp;Partially Connected Structure</h4>
<p>Here’s an example comparing a fully connected structure and a partially connected structure (with weight sharing):</p>
<div id="2e53508e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fully connected example (for simplicity, consider a 3x3 image and a 3x3 filter)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>image_fc <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fully connected: Every pixel connects to every neuron</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>fully_connected <span class="op">=</span> np.<span class="bu">sum</span>(image_fc)  <span class="co"># Total sum of all pixels as a single feature</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolutional: Weight sharing via the filter (same filter applied across the image)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>filter_fc <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolutional operation (using valid padding)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>conv_output <span class="op">=</span> np.zeros_like(image_fc)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(image_fc.shape[<span class="dv">0</span>] <span class="op">-</span> filter_fc.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(image_fc.shape[<span class="dv">1</span>] <span class="op">-</span> filter_fc.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        region <span class="op">=</span> image_fc[i:i <span class="op">+</span> <span class="dv">3</span>, j:j <span class="op">+</span> <span class="dv">3</span>]</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        conv_output[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(region <span class="op">*</span> filter_fc)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Fully Connected Output: </span><span class="sc">{</span>fully_connected<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Convolutional Output (Weight Sharing):</span><span class="ch">\n</span><span class="sc">{</span>conv_output<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fully Connected Output: 45
Convolutional Output (Weight Sharing):
[[25  0  0]
 [ 0  0  0]
 [ 0  0  0]]</code></pre>
</div>
</div>
<p>In this example, the fully connected output is just the sum of all pixels, treating them as a single feature. In contrast, the convolutional output uses a filter that scans across the image and reuses weights, showing how CNNs are more efficient in terms of the number of parameters.</p>
</section>
</section>
<section id="image-representation-channels-pixels-and-depth" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="image-representation-channels-pixels-and-depth"><span class="header-section-number">15.2.4</span> Image Representation: Channels, Pixels, and Depth</h3>
<p>In a colored image, each pixel is represented by multiple values that correspond to different channels. For a typical RGB (Red, Green, Blue) image, each pixel has three values corresponding to the intensities of these three colors.</p>
<section id="how-images-are-represented-as-matrices" class="level4" data-number="15.2.4.1">
<h4 data-number="15.2.4.1" class="anchored" data-anchor-id="how-images-are-represented-as-matrices"><span class="header-section-number">15.2.4.1</span> How Images are Represented as Matrices</h4>
<p>An image is often represented as a 3D matrix with the shape:</p>
<p><span class="math display">\[
\text{Image} = \text{Height} \times \text{Width} \times \text{Channels}
\]</span></p>
<ul>
<li><strong>Height</strong>: The number of rows (or pixels along the vertical axis).</li>
<li><strong>Width</strong>: The number of columns (or pixels along the horizontal axis).</li>
<li><strong>Channels</strong>: The number of color channels (e.g., RGB has 3 channels).</li>
</ul>
<p>For example, a 10x10 image with 3 channels (RGB) would be represented as a matrix of shape ( [10, 10, 3] ).</p>
<section id="analogy" class="level5" data-number="15.2.4.1.1">
<h5 data-number="15.2.4.1.1" class="anchored" data-anchor-id="analogy"><span class="header-section-number">15.2.4.1.1</span> Analogy</h5>
<p>A colored image is like a box of crayons, where each crayon (channel) represents a different color. Just like how a box of crayons has multiple colors, an image has multiple channels (e.g., Red, Green, Blue).</p>
</section>
</section>
<section id="python-example-representing-a-colored-image-matrix-in-numpy" class="level4" data-number="15.2.4.2">
<h4 data-number="15.2.4.2" class="anchored" data-anchor-id="python-example-representing-a-colored-image-matrix-in-numpy"><span class="header-section-number">15.2.4.2</span> Python Example: Representing a Colored Image Matrix in NumPy</h4>
<p>Here’s a Python example to represent an RGB image as a 3D matrix using NumPy:</p>
<div id="59fecb5b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 10x10 image with 3 color channels (RGB)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>height, width <span class="op">=</span> <span class="dv">10</span>, <span class="dv">10</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>channels <span class="op">=</span> <span class="dv">3</span>  <span class="co"># RGB channels</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Random image with pixel intensities between 0 and 255</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>image_rgb <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">256</span>, (height, width, channels))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RGB Image Matrix (10x10x3):"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image_rgb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RGB Image Matrix (10x10x3):
[[[ 24 161  97]
  [197 146  26]
  [  8 231 216]
  [205 115 250]
  [240  19 152]
  [219  30 206]
  [ 83 218   2]
  [110   6 175]
  [184  66  51]
  [110 164 148]]

 [[175 190  93]
  [176 181  22]
  [164 127 113]
  [ 33  61  94]
  [131 160  73]
  [ 80 213  70]
  [ 41  40  71]
  [175 116 171]
  [ 16  56  95]
  [184  71  56]]

 [[168  36 111]
  [232  21 197]
  [225  87 125]
  [  3 170  43]
  [238 114 171]
  [ 69 216  97]
  [154 166 116]
  [187 124  16]
  [212 159 242]
  [ 19 192 231]]

 [[ 45 114  94]
  [ 56  69 108]
  [193 241 158]
  [ 51 175  40]
  [ 64 194 180]
  [201  42 178]
  [236 167  61]
  [ 11   9  78]
  [174 229  84]
  [177 254 231]]

 [[ 87 233  39]
  [220  58 128]
  [250 134 137]
  [ 64  60 142]
  [184 209  21]
  [153  33  45]
  [ 57 223  59]
  [ 51 108  56]
  [  8  64 124]
  [ 22  47 102]]

 [[ 52 116 159]
  [156 183   7]
  [ 39  85 163]
  [231 214 153]
  [247  79 107]
  [154 163 133]
  [219 248 244]
  [216 157  76]
  [ 57  55  66]
  [109  94 137]]

 [[148  74 219]
  [ 20  47   7]
  [159 232 110]
  [200  14  89]
  [  1 163  61]
  [231   4 184]
  [253 159 236]
  [173  62 101]
  [ 69 228  80]
  [ 84  49  98]]

 [[112 153 141]
  [102  51  16]
  [250 184 144]
  [ 24 213 210]
  [160 232  64]
  [ 58 132 174]
  [191 101  99]
  [116  21 136]
  [113 178 154]
  [254  83  25]]

 [[  0 238   6]
  [223 206 219]
  [209 209 104]
  [ 20 216  90]
  [ 73 174 154]
  [194   4 206]
  [ 73  71  75]
  [139 114 115]
  [148 129 171]
  [158 240 123]]

 [[135  34 105]
  [177 122 243]
  [ 79   4  73]
  [  1 243 128]
  [ 12 169  22]
  [119 100 114]
  [226 139 182]
  [178  39  18]
  [204 131 155]
  [131 239 169]]]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="building-blocks-of-cnns" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="building-blocks-of-cnns"><span class="header-section-number">15.3</span> Building Blocks of CNNs</h2>
<p>The power of Convolutional Neural Networks (CNNs) lies in the interplay between their building blocks: <strong>Convolutional Layers</strong>, <strong>Pooling Layers</strong>, and <strong>Fully Connected (Dense) Layers</strong>. These components work together to process and learn from image data, progressively refining the features extracted to make better predictions.</p>
<section id="convolution-layer" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="convolution-layer"><span class="header-section-number">15.3.1</span> Convolution Layer</h3>
<p>The Convolution Layer is the heart of a CNN. It’s responsible for extracting features from the input image by applying filters (kernels) to the image.</p>
<section id="understanding-filters-kernels-and-feature-maps" class="level4" data-number="15.3.1.1">
<h4 data-number="15.3.1.1" class="anchored" data-anchor-id="understanding-filters-kernels-and-feature-maps"><span class="header-section-number">15.3.1.1</span> Understanding Filters (Kernels) and Feature Maps</h4>
<ul>
<li><strong>Filters (or Kernels)</strong>: Filters are small matrices used to scan over the image. Each filter is designed to detect certain patterns or features (like edges, corners, textures, etc.).</li>
<li><strong>Feature Maps</strong>: The result of applying a filter over an image. These maps highlight the detected features in different regions of the image.</li>
</ul>
</section>
<section id="how-filters-detect-specific-features" class="level4" data-number="15.3.1.2">
<h4 data-number="15.3.1.2" class="anchored" data-anchor-id="how-filters-detect-specific-features"><span class="header-section-number">15.3.1.2</span> How Filters Detect Specific Features</h4>
<p>Filters scan the image through convolution operations, and depending on the filter’s values, they may highlight edges, corners, or other features in the image.</p>
</section>
<section id="example-visualizing-filters-and-their-outputs" class="level4" data-number="15.3.1.3">
<h4 data-number="15.3.1.3" class="anchored" data-anchor-id="example-visualizing-filters-and-their-outputs"><span class="header-section-number">15.3.1.3</span> Example: Visualizing Filters and Their Outputs</h4>
<p>In this Python example, we will visualize a filter (kernel) and see how it detects edges in an image using a simple convolution operation.</p>
<div id="cec26836" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example image (grayscale)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a simple edge detection filter (Sobel operator)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>filter_ <span class="op">=</span> np.array([[<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                    [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                    [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform convolution (valid padding)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> np.zeros_like(image)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolution operation (valid padding)</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(image.shape[<span class="dv">0</span>] <span class="op">-</span> filter_.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(image.shape[<span class="dv">1</span>] <span class="op">-</span> filter_.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        region <span class="op">=</span> image[i:i <span class="op">+</span> <span class="dv">3</span>, j:j <span class="op">+</span> <span class="dv">3</span>]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        output[i, j] <span class="op">=</span> np.<span class="bu">sum</span>(region <span class="op">*</span> filter_)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the original image and the feature map (edge-detection)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Original Image"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Edge Detection Feature Map"</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>plt.imshow(output, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter13_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In this example, we use a simple Sobel edge detection filter to highlight vertical edges in the image. The result is a feature map that shows where edges are detected.</p>
<p><strong>Analogy</strong><br>
Imagine a magnifying glass over an image: just as a magnifying glass helps you zoom into specific areas to find tiny details, the filter slides over the image and focuses on detecting specific features like edges, corners, or textures.</p>
</section>
</section>
<section id="pooling-layer" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="pooling-layer"><span class="header-section-number">15.3.2</span> Pooling Layer</h3>
<p>The Pooling Layer is used to reduce the spatial dimensions (height and width) of the image while retaining important features. This is especially useful in CNNs because it reduces computational complexity and helps prevent overfitting.</p>
<section id="the-role-of-pooling-in-cnns" class="level4" data-number="15.3.2.1">
<h4 data-number="15.3.2.1" class="anchored" data-anchor-id="the-role-of-pooling-in-cnns"><span class="header-section-number">15.3.2.1</span> The Role of Pooling in CNNs</h4>
<p>Pooling is essentially a form of down-sampling, where we reduce the resolution of the image to focus on its most important features. The pooling layer summarizes the input feature map and makes the network more efficient by reducing the number of parameters.</p>
</section>
<section id="max-pooling" class="level4" data-number="15.3.2.2">
<h4 data-number="15.3.2.2" class="anchored" data-anchor-id="max-pooling"><span class="header-section-number">15.3.2.2</span> Max Pooling</h4>
<p>Max Pooling is the most common type of pooling. In max pooling, a filter (usually 2x2) slides over the image, and for each region, it selects the maximum value. This reduces the spatial dimensions of the image but retains the most important features.</p>
</section>
<section id="example-max-pooling-with-python" class="level4" data-number="15.3.2.3">
<h4 data-number="15.3.2.3" class="anchored" data-anchor-id="example-max-pooling-with-python"><span class="header-section-number">15.3.2.3</span> Example: Max Pooling with Python</h4>
<p>Here’s an example of how max pooling works using a 2x2 filter:</p>
<div id="92a41a55" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example feature map (from previous convolution output)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>feature_map <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                        [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                        [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">2</span>],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                        [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Max pooling with a 2x2 filter</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> max_pooling(feature_map, pool_size<span class="op">=</span><span class="dv">2</span>, stride<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Output dimensions</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    output_height <span class="op">=</span> (feature_map.shape[<span class="dv">0</span>] <span class="op">-</span> pool_size) <span class="op">//</span> stride <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    output_width <span class="op">=</span> (feature_map.shape[<span class="dv">1</span>] <span class="op">-</span> pool_size) <span class="op">//</span> stride <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    pooled_map <span class="op">=</span> np.zeros((output_height, output_width))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, feature_map.shape[<span class="dv">0</span>] <span class="op">-</span> pool_size <span class="op">+</span> <span class="dv">1</span>, stride):</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, feature_map.shape[<span class="dv">1</span>] <span class="op">-</span> pool_size <span class="op">+</span> <span class="dv">1</span>, stride):</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            region <span class="op">=</span> feature_map[i:i <span class="op">+</span> pool_size, j:j <span class="op">+</span> pool_size]</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            pooled_map[i <span class="op">//</span> stride, j <span class="op">//</span> stride] <span class="op">=</span> np.<span class="bu">max</span>(region)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pooled_map</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply max pooling</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>pooled_output <span class="op">=</span> max_pooling(feature_map)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Pooled Feature Map (Max Pooling):"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pooled_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pooled Feature Map (Max Pooling):
[[5. 6.]
 [8. 9.]]</code></pre>
</div>
</div>
<p>In this example, we use a 2x2 pooling filter with a stride of 2 to reduce the dimensions of the feature map. The result is a smaller, more abstracted feature map, with only the maximum values retained.</p>
<p><strong>Analogy</strong><br>
Think of pooling as summarizing a large text into a few important keywords. You extract the most critical information (like the highest values in a region) to understand the core content, without getting bogged down in all the details.</p>
</section>
</section>
<section id="fully-connected-layer-dense-layer" class="level3" data-number="15.3.3">
<h3 data-number="15.3.3" class="anchored" data-anchor-id="fully-connected-layer-dense-layer"><span class="header-section-number">15.3.3</span> Fully Connected Layer (Dense Layer)</h3>
<p>The Fully Connected Layer (Dense Layer) is where the network makes final decisions. After several convolutions and pooling operations, the network has learned abstract features of the image. These features are passed to a fully connected layer for classification.</p>
<section id="transition-from-convolution-and-pooling-to-fully-connected-layers" class="level4" data-number="15.3.3.1">
<h4 data-number="15.3.3.1" class="anchored" data-anchor-id="transition-from-convolution-and-pooling-to-fully-connected-layers"><span class="header-section-number">15.3.3.1</span> Transition from Convolution and Pooling to Fully Connected Layers</h4>
<p>After feature extraction through convolution and pooling, the flattened feature map is passed to a fully connected layer. This layer uses learned weights and biases to compute a final output, such as a classification label.</p>
</section>
<section id="use-of-activation-functions-relu-and-softmax" class="level4" data-number="15.3.3.2">
<h4 data-number="15.3.3.2" class="anchored" data-anchor-id="use-of-activation-functions-relu-and-softmax"><span class="header-section-number">15.3.3.2</span> Use of Activation Functions: ReLU and Softmax</h4>
<ul>
<li><strong>ReLU (Rectified Linear Unit)</strong>: Commonly used in CNNs to introduce non-linearity, helping the model learn more complex patterns.</li>
<li><strong>Softmax</strong>: Typically used in the final fully connected layer for multi-class classification problems, as it converts the raw output into probabilities that sum to 1.</li>
</ul>
</section>
<section id="example-simple-python-model-ending-with-a-dense-layer" class="level4" data-number="15.3.3.3">
<h4 data-number="15.3.3.3" class="anchored" data-anchor-id="example-simple-python-model-ending-with-a-dense-layer"><span class="header-section-number">15.3.3.3</span> Example: Simple Python Model Ending with a Dense Layer</h4>
<p>Here’s a simple Python example using Keras to build a CNN that ends with a dense layer for classification. The model will use ReLU and Softmax activation functions.</p>
<div id="37034ea6" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv2D, MaxPooling2D, Flatten, Dense</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple CNN model</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolutional layer with 32 filters, 3x3 filter size, ReLU activation</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Max pooling layer with 2x2 pool size</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the output from the previous layer</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fully connected (dense) layer with 128 neurons and ReLU activation</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Output layer with Softmax activation (for multi-class classification)</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>))  <span class="co"># For 10 classes</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\roess\Documents\repos\Notes\myvenv312\Lib\site-packages\keras\src\layers\convolutional\base_conv.py:107: UserWarning:

Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv2d (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │           <span style="color: #00af00; text-decoration-color: #00af00">320</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)    │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ flatten (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">5408</span>)           │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)            │       <span style="color: #00af00; text-decoration-color: #00af00">692,352</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>)             │         <span style="color: #00af00; text-decoration-color: #00af00">1,290</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">693,962</span> (2.65 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">693,962</span> (2.65 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level3" data-number="15.3.4">
<h3 data-number="15.3.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">15.3.4</span> Summary</h3>
<ul>
<li><strong>Convolutional Layers</strong>: Extract features like edges, textures, and shapes from images.</li>
<li><strong>Pooling Layers</strong>: Reduce the size of feature maps, retaining important features.</li>
<li><strong>Fully Connected Layers</strong>: Make the final decision, using learned features to classify the image.</li>
</ul>
<p>Through these three building blocks—convolution, pooling, and fully connected layers—CNNs efficiently process images, learning increasingly abstract features that help in image classification tasks.</p>
</section>
</section>
<section id="cnn-architecture-and-layers" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="cnn-architecture-and-layers"><span class="header-section-number">15.4</span> CNN Architecture and Layers</h2>
<section id="layer-by-layer-breakdown" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="layer-by-layer-breakdown"><span class="header-section-number">15.4.1</span> Layer-by-Layer Breakdown</h3>
<p>CNNs are structured in a sequential manner where each layer extracts increasingly complex features from the image. These layers work together to transform raw pixel data into meaningful representations used for classification or object detection.</p>
<section id="layer-by-layer-breakdown-1" class="level4" data-number="15.4.1.1">
<h4 data-number="15.4.1.1" class="anchored" data-anchor-id="layer-by-layer-breakdown-1"><span class="header-section-number">15.4.1.1</span> Layer-by-Layer Breakdown</h4>
<p>A typical CNN consists of the following layers, arranged in a structured manner:</p>
<ul>
<li><strong>Convolutional Layers</strong> – Extract features using filters/kernels.</li>
<li><strong>Pooling Layers</strong> – Reduce spatial dimensions while retaining important features.</li>
<li><strong>Fully Connected (Dense) Layers</strong> – Make final predictions using extracted features.</li>
</ul>
<p>Most CNN architectures follow this pattern but vary in the number and types of layers used.</p>
</section>
<section id="typical-cnn-architectures" class="level4" data-number="15.4.1.2">
<h4 data-number="15.4.1.2" class="anchored" data-anchor-id="typical-cnn-architectures"><span class="header-section-number">15.4.1.2</span> Typical CNN Architectures</h4>
<p>Several famous CNN architectures have significantly influenced deep learning:</p>
<ul>
<li><strong>LeNet-5 (1998)</strong> – One of the earliest CNNs designed for digit recognition.</li>
<li><strong>AlexNet (2012)</strong> – Popularized deep CNNs, winning the ImageNet competition.</li>
<li><strong>VGGNet (2014)</strong> – Used very deep networks (16+ layers) for better feature extraction.</li>
<li><strong>ResNet (2015)</strong> – Introduced residual connections to solve vanishing gradient issues.</li>
</ul>
</section>
<section id="example-defining-a-simple-cnn-architecture-in-keras" class="level4" data-number="15.4.1.3">
<h4 data-number="15.4.1.3" class="anchored" data-anchor-id="example-defining-a-simple-cnn-architecture-in-keras"><span class="header-section-number">15.4.1.3</span> Example: Defining a Simple CNN Architecture in Keras</h4>
<p>Below is a simple CNN architecture using Keras, similar to those used in early image classification tasks.</p>
<div id="46f80e8f" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv2D, MaxPooling2D, Flatten, Dense</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a simple CNN model</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convolutional Layer (Extracts Features)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Second Convolutional Layer</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the 2D feature maps into a 1D vector</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fully Connected Layers</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>))  <span class="co"># Output layer for 10 classes</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the model architecture</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential_1"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │           <span style="color: #00af00; text-decoration-color: #00af00">320</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">11</span>, <span style="color: #00af00; text-decoration-color: #00af00">11</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)     │        <span style="color: #00af00; text-decoration-color: #00af00">18,496</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">5</span>, <span style="color: #00af00; text-decoration-color: #00af00">5</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)       │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ flatten_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)             │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1600</span>)           │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)            │       <span style="color: #00af00; text-decoration-color: #00af00">204,928</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>)             │         <span style="color: #00af00; text-decoration-color: #00af00">1,290</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">225,034</span> (879.04 KB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">225,034</span> (879.04 KB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
<p>Explanation: - <code>Conv2D(32, (3,3))</code>: A convolutional layer with 32 filters of size 3×3. - <code>MaxPooling2D(2,2)</code>: Down-samples the feature map to retain important information. - <code>Flatten()</code>: Converts 2D feature maps into a 1D vector. - <code>Dense(128, activation='relu')</code>: A fully connected layer with 128 neurons. - <code>Dense(10, activation='softmax')</code>: The final layer for classification into 10 categories.</p>
</section>
</section>
<section id="training-cnns-forward-propagation-and-backpropagation" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="training-cnns-forward-propagation-and-backpropagation"><span class="header-section-number">15.4.2</span> Training CNNs: Forward Propagation and Backpropagation</h3>
<p>Training a CNN involves two key steps: forward propagation (where the network makes predictions) and backpropagation (where it learns from its mistakes).</p>
</section>
<section id="forward-propagation-making-predictions" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="forward-propagation-making-predictions"><span class="header-section-number">15.4.3</span> Forward Propagation: Making Predictions</h3>
<p>During forward propagation:</p>
<ul>
<li>Each layer applies transformations to the input (convolution, activation, pooling).</li>
<li>Features are extracted progressively.</li>
<li>Fully connected layers use these features to make predictions.</li>
</ul>
<p><strong>Analogy</strong>:<br>
Think of forward propagation as solving a maze: - You start at the entrance (input image). - You make a series of choices (filters detecting patterns). - You reach an exit (prediction) based on your path.</p>
<section id="backpropagation-learning-from-mistakes" class="level4" data-number="15.4.3.1">
<h4 data-number="15.4.3.1" class="anchored" data-anchor-id="backpropagation-learning-from-mistakes"><span class="header-section-number">15.4.3.1</span> Backpropagation: Learning from Mistakes</h4>
<p>Once predictions are made, the network compares them to the actual labels and computes the error using a loss function.</p>
<p>During backpropagation:</p>
<ul>
<li>Gradients are computed using the chain rule.</li>
<li>Weights are updated to reduce the error using an optimization algorithm (like Adam or SGD).</li>
<li>The process repeats until the model learns to make accurate predictions.</li>
</ul>
<p><strong>Analogy</strong>:<br>
Backpropagation is like re-tracing your steps in a maze: - If you hit a dead end (wrong prediction), you go back and adjust your path. - Each time you retry, you get closer to the correct exit (better prediction).</p>
</section>
<section id="example-training-a-cnn-in-keras" class="level4" data-number="15.4.3.2">
<h4 data-number="15.4.3.2" class="anchored" data-anchor-id="example-training-a-cnn-in-keras"><span class="header-section-number">15.4.3.2</span> Example: Training a CNN in Keras</h4>
<p>Below is a Python example that demonstrates how to train a CNN using Keras and TensorFlow.</p>
<div id="d58b99df" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.datasets <span class="im">import</span> mnist</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load MNIST dataset (handwritten digits)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>(x_train, y_train), (x_test, y_test) <span class="op">=</span> mnist.load_data()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize pixel values (0 to 1)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>x_train, x_test <span class="op">=</span> x_train <span class="op">/</span> <span class="fl">255.0</span>, x_test <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape to add a single channel dimension (grayscale images)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x_train.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x_test.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert labels to one-hot encoding</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> to_categorical(y_train, <span class="dv">10</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> to_categorical(y_test, <span class="dv">10</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a CNN model</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)),</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    Flatten(),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile the model</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>model.fit(x_train, y_train, epochs<span class="op">=</span><span class="dv">5</span>, batch_size<span class="op">=</span><span class="dv">32</span>, validation_data<span class="op">=</span>(x_test, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
   1/1875 ━━━━━━━━━━━━━━━━━━━━ 52:44 2s/step - accuracy: 0.0938 - loss: 2.3196   7/1875 ━━━━━━━━━━━━━━━━━━━━ 17s 9ms/step - accuracy: 0.1212 - loss: 2.2759   13/1875 ━━━━━━━━━━━━━━━━━━━━ 17s 9ms/step - accuracy: 0.1936 - loss: 2.2077  20/1875 ━━━━━━━━━━━━━━━━━━━━ 16s 9ms/step - accuracy: 0.2684 - loss: 2.1090  27/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.3230 - loss: 2.0034  34/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.3683 - loss: 1.9003  42/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.4093 - loss: 1.7966  48/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.4350 - loss: 1.7275  54/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.4577 - loss: 1.6636  60/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.4787 - loss: 1.6041  66/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.4974 - loss: 1.5509  73/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.5173 - loss: 1.4939  79/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.5329 - loss: 1.4489  85/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.5472 - loss: 1.4077  92/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.5624 - loss: 1.3635  99/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.5764 - loss: 1.3226 106/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.5894 - loss: 1.2847 113/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6013 - loss: 1.2496 120/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6122 - loss: 1.2172 126/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6209 - loss: 1.1911 133/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6305 - loss: 1.1628 139/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6381 - loss: 1.1398 145/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6454 - loss: 1.1181 152/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6533 - loss: 1.0941 158/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6597 - loss: 1.0746 164/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6659 - loss: 1.0561 171/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6726 - loss: 1.0355 178/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6791 - loss: 1.0160 183/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6834 - loss: 1.0028 190/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6893 - loss: 0.9852 197/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.6948 - loss: 0.9684 204/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.7001 - loss: 0.9523 211/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7051 - loss: 0.9369 218/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7099 - loss: 0.9222 224/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7138 - loss: 0.9100 231/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7183 - loss: 0.8964 238/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7225 - loss: 0.8833 245/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7266 - loss: 0.8707 252/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7305 - loss: 0.8586 259/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7343 - loss: 0.8469 266/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7379 - loss: 0.8357 273/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7414 - loss: 0.8250 279/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7443 - loss: 0.8160 286/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7476 - loss: 0.8060 293/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7507 - loss: 0.7962 299/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.7534 - loss: 0.7881 306/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7563 - loss: 0.7788 313/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7592 - loss: 0.7699 320/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7620 - loss: 0.7612 327/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7647 - loss: 0.7529 334/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7673 - loss: 0.7448 340/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7694 - loss: 0.7380 348/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7722 - loss: 0.7293 356/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7749 - loss: 0.7208 364/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7776 - loss: 0.7126 371/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7798 - loss: 0.7056 378/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7820 - loss: 0.6988 385/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7841 - loss: 0.6922 392/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7862 - loss: 0.6857 399/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.7882 - loss: 0.6794 406/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7901 - loss: 0.6732 413/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7920 - loss: 0.6673 419/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7936 - loss: 0.6622 426/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7955 - loss: 0.6565 432/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7970 - loss: 0.6516 438/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7985 - loss: 0.6469 445/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8002 - loss: 0.6415 452/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8019 - loss: 0.6362 459/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8036 - loss: 0.6310 466/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8052 - loss: 0.6259 473/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8067 - loss: 0.6210 480/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8083 - loss: 0.6161 487/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8098 - loss: 0.6114 494/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8113 - loss: 0.6067 500/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8125 - loss: 0.6028 507/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8139 - loss: 0.5984 514/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8153 - loss: 0.5940 521/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.8166 - loss: 0.5897 528/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8180 - loss: 0.5855 535/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8193 - loss: 0.5814 542/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8205 - loss: 0.5773 549/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8218 - loss: 0.5733 556/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8230 - loss: 0.5694 564/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8244 - loss: 0.5650 572/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8258 - loss: 0.5607 580/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8271 - loss: 0.5565 587/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8282 - loss: 0.5529 594/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8293 - loss: 0.5494 601/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8304 - loss: 0.5459 608/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8315 - loss: 0.5424 615/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8326 - loss: 0.5391 623/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.8338 - loss: 0.5353 631/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8349 - loss: 0.5315  639/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8361 - loss: 0.5279 647/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8372 - loss: 0.5243 655/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8383 - loss: 0.5208 663/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8394 - loss: 0.5173 672/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8406 - loss: 0.5135 680/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8417 - loss: 0.5102 687/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8425 - loss: 0.5073 695/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8436 - loss: 0.5041 702/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8444 - loss: 0.5014 708/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8452 - loss: 0.4990 715/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8460 - loss: 0.4963 721/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8467 - loss: 0.4941 729/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8477 - loss: 0.4911 736/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.8485 - loss: 0.4885 744/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8494 - loss: 0.4856 751/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8502 - loss: 0.4830 759/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8511 - loss: 0.4802 766/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8518 - loss: 0.4778 774/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8527 - loss: 0.4750 782/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8535 - loss: 0.4723 790/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8544 - loss: 0.4697 798/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8552 - loss: 0.4671 806/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8560 - loss: 0.4645 814/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8568 - loss: 0.4619 822/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8576 - loss: 0.4594 830/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8583 - loss: 0.4569 837/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8590 - loss: 0.4548 845/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.8598 - loss: 0.4524 852/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8604 - loss: 0.4503 858/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8610 - loss: 0.4485 865/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8616 - loss: 0.4465 873/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8623 - loss: 0.4442 881/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8630 - loss: 0.4419 889/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8637 - loss: 0.4397 897/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8644 - loss: 0.4375 905/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8651 - loss: 0.4354 912/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8657 - loss: 0.4335 920/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8663 - loss: 0.4314 928/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8670 - loss: 0.4293 935/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8675 - loss: 0.4275 943/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8682 - loss: 0.4255 951/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8688 - loss: 0.4235 958/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.8693 - loss: 0.4217 966/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8699 - loss: 0.4198 974/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8705 - loss: 0.4178 983/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8712 - loss: 0.4157 991/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8718 - loss: 0.4138 999/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8724 - loss: 0.41201006/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8729 - loss: 0.41041014/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8734 - loss: 0.40851022/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8740 - loss: 0.40671030/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8746 - loss: 0.40501038/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8751 - loss: 0.40321046/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8756 - loss: 0.40151054/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8762 - loss: 0.39981061/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8766 - loss: 0.39831068/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8771 - loss: 0.39681076/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8776 - loss: 0.39521084/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.8781 - loss: 0.39361092/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8786 - loss: 0.39191100/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8791 - loss: 0.39031108/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8796 - loss: 0.38881115/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8800 - loss: 0.38741122/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8805 - loss: 0.38611130/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8809 - loss: 0.38451137/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8814 - loss: 0.38321144/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8818 - loss: 0.38191150/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8821 - loss: 0.38081157/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8825 - loss: 0.37951164/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8829 - loss: 0.37821171/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8833 - loss: 0.37691177/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8836 - loss: 0.37591184/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8840 - loss: 0.37461192/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8845 - loss: 0.37321200/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8849 - loss: 0.37181207/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8853 - loss: 0.37061214/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step - accuracy: 0.8857 - loss: 0.36941221/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8860 - loss: 0.36821229/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8864 - loss: 0.36691237/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8869 - loss: 0.36561244/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8872 - loss: 0.36441251/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8876 - loss: 0.36331259/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8880 - loss: 0.36201265/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8883 - loss: 0.36101272/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8886 - loss: 0.35991278/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8889 - loss: 0.35901285/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8893 - loss: 0.35791291/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8895 - loss: 0.35691298/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8899 - loss: 0.35591305/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8902 - loss: 0.35481312/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8905 - loss: 0.35371319/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8909 - loss: 0.35271326/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8912 - loss: 0.35161334/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8916 - loss: 0.35051340/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8918 - loss: 0.34961346/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 8ms/step - accuracy: 0.8921 - loss: 0.34871353/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8924 - loss: 0.34771360/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8927 - loss: 0.34671367/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8930 - loss: 0.34571375/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8934 - loss: 0.34461383/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8937 - loss: 0.34341390/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8940 - loss: 0.34251397/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8943 - loss: 0.34151403/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8946 - loss: 0.34071410/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8949 - loss: 0.33971417/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8952 - loss: 0.33881424/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8955 - loss: 0.33791432/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8958 - loss: 0.33681440/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8961 - loss: 0.33571447/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8964 - loss: 0.33481454/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8967 - loss: 0.33391461/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8970 - loss: 0.33301468/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8973 - loss: 0.33211475/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8975 - loss: 0.33121482/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 8ms/step - accuracy: 0.8978 - loss: 0.33041488/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8980 - loss: 0.32961493/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8982 - loss: 0.32901496/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8984 - loss: 0.32861501/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8985 - loss: 0.32801507/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8988 - loss: 0.32731513/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8990 - loss: 0.32651519/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8992 - loss: 0.32581526/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8995 - loss: 0.32501534/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.8998 - loss: 0.32401541/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9000 - loss: 0.32321548/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9003 - loss: 0.32241556/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9006 - loss: 0.32141564/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9009 - loss: 0.32051572/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9012 - loss: 0.31961578/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9014 - loss: 0.31891582/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9015 - loss: 0.31851587/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9017 - loss: 0.31791592/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9019 - loss: 0.31731598/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9021 - loss: 0.31671605/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9023 - loss: 0.31591611/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.9025 - loss: 0.31521618/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9028 - loss: 0.31451625/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9030 - loss: 0.31371632/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9032 - loss: 0.31291639/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9035 - loss: 0.31221647/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9037 - loss: 0.31131654/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9040 - loss: 0.31061663/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9043 - loss: 0.30971670/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9045 - loss: 0.30891678/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9047 - loss: 0.30811686/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9050 - loss: 0.30731695/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9053 - loss: 0.30641703/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9055 - loss: 0.30551711/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9058 - loss: 0.30471719/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9060 - loss: 0.30401727/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9063 - loss: 0.30321734/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9065 - loss: 0.30251741/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.9067 - loss: 0.30181746/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9069 - loss: 0.30131750/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9070 - loss: 0.30091756/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9072 - loss: 0.30031762/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9073 - loss: 0.29981768/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9075 - loss: 0.29921775/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9077 - loss: 0.29851782/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9079 - loss: 0.29791789/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9081 - loss: 0.29721797/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9084 - loss: 0.29651804/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9086 - loss: 0.29581812/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9088 - loss: 0.29511819/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9090 - loss: 0.29451827/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9092 - loss: 0.29381834/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9094 - loss: 0.29311842/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9096 - loss: 0.29241849/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9098 - loss: 0.29181855/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9100 - loss: 0.29131861/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9101 - loss: 0.29071866/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9103 - loss: 0.29031872/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.9104 - loss: 0.28981875/1875 ━━━━━━━━━━━━━━━━━━━━ 17s 8ms/step - accuracy: 0.9106 - loss: 0.2894 - val_accuracy: 0.9849 - val_loss: 0.0440
Epoch 2/5
   1/1875 ━━━━━━━━━━━━━━━━━━━━ 1:20 43ms/step - accuracy: 0.9062 - loss: 0.4995   7/1875 ━━━━━━━━━━━━━━━━━━━━ 18s 10ms/step - accuracy: 0.9511 - loss: 0.2226   13/1875 ━━━━━━━━━━━━━━━━━━━━ 16s 9ms/step - accuracy: 0.9656 - loss: 0.1542   19/1875 ━━━━━━━━━━━━━━━━━━━━ 16s 9ms/step - accuracy: 0.9706 - loss: 0.1267  26/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9729 - loss: 0.1108  33/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9749 - loss: 0.1004  40/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9762 - loss: 0.0931  48/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9771 - loss: 0.0872  56/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9780 - loss: 0.0823  63/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9787 - loss: 0.0785  70/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9794 - loss: 0.0751  77/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9801 - loss: 0.0721  85/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9807 - loss: 0.0692  93/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9813 - loss: 0.0666 101/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9817 - loss: 0.0646 108/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9820 - loss: 0.0630 116/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9823 - loss: 0.0615 123/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9826 - loss: 0.0604 130/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9828 - loss: 0.0593 137/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9830 - loss: 0.0583 144/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9832 - loss: 0.0575 151/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9834 - loss: 0.0567 158/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9836 - loss: 0.0560 165/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9838 - loss: 0.0553 172/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9840 - loss: 0.0547 179/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9841 - loss: 0.0541 187/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9843 - loss: 0.0535 194/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9844 - loss: 0.0530 201/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9845 - loss: 0.0525 208/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9846 - loss: 0.0521 215/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9847 - loss: 0.0517 222/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9848 - loss: 0.0513 228/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9849 - loss: 0.0510 235/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9850 - loss: 0.0507 242/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9851 - loss: 0.0504 248/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9852 - loss: 0.0501 255/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9853 - loss: 0.0499 262/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9853 - loss: 0.0496 269/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9854 - loss: 0.0493 276/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9855 - loss: 0.0491 283/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9856 - loss: 0.0489 290/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9856 - loss: 0.0487 297/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9857 - loss: 0.0485 303/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9858 - loss: 0.0483 310/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9858 - loss: 0.0481 317/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9859 - loss: 0.0480 324/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9859 - loss: 0.0479 331/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9859 - loss: 0.0478 337/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9860 - loss: 0.0477 345/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9860 - loss: 0.0476 352/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9860 - loss: 0.0475 359/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9861 - loss: 0.0475 366/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9861 - loss: 0.0474 374/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9861 - loss: 0.0473 380/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9861 - loss: 0.0473 387/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0473 394/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0472 401/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0472 407/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0472 413/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0471 420/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0471 427/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9862 - loss: 0.0471 435/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.9863 - loss: 0.0470 442/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0470 450/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0470 457/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0470 463/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0470 469/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0469 474/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9863 - loss: 0.0469 481/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0469 488/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0469 496/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0468 503/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0468 510/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0468 518/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0468 525/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0468 531/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0467 538/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0467 544/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0467 550/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9864 - loss: 0.0467 557/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9865 - loss: 0.0467 564/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9865 - loss: 0.0467 571/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9865 - loss: 0.0467 578/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9865 - loss: 0.0467 585/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 8ms/step - accuracy: 0.9865 - loss: 0.0467 592/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466  599/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 606/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 613/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 620/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 627/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 634/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 640/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 647/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 654/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 661/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 668/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 675/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 682/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0466 689/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0465 696/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0465 703/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0465 710/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.9865 - loss: 0.0465 718/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0465 725/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0465 732/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0465 739/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0465 746/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 753/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 760/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 768/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 776/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 784/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0464 791/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 799/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 806/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 814/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 823/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 830/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 8ms/step - accuracy: 0.9865 - loss: 0.0463 838/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0462 846/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0462 854/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0462 861/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0462 869/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0462 877/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 885/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 893/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 901/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 909/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 917/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 926/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 934/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 941/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0461 949/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 8ms/step - accuracy: 0.9865 - loss: 0.0460 957/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.0460 965/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.0460 973/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.0460 981/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.0460 989/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.0460 997/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04601005/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04601014/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04601022/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04591030/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04591037/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04591044/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04591051/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 8ms/step - accuracy: 0.9865 - loss: 0.04591059/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9865 - loss: 0.04591066/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9865 - loss: 0.04591074/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9865 - loss: 0.04581082/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04581089/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04581097/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04581106/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04581113/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04581121/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571129/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571136/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571144/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571151/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571158/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04571166/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04561174/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9865 - loss: 0.04561182/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9866 - loss: 0.04561190/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9866 - loss: 0.04561197/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9866 - loss: 0.04561205/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04561213/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551222/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551229/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551236/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551243/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551250/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551257/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04551265/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541272/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541279/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541286/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541293/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541300/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541308/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541315/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541323/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04541330/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04531337/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9866 - loss: 0.04531344/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531352/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531358/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531365/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531371/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531378/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04531385/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521392/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521399/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521405/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521411/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521417/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521424/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521431/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9866 - loss: 0.04521438/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9867 - loss: 0.04511445/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9867 - loss: 0.04511453/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9867 - loss: 0.04511461/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9867 - loss: 0.04511469/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9867 - loss: 0.04511478/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04511486/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04511494/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501503/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501510/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501518/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501526/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501534/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501542/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04501550/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491558/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491566/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491574/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491582/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491590/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491599/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9867 - loss: 0.04491607/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481614/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481622/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481630/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481637/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481646/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481653/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04481661/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04471669/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04471677/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04471685/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04471693/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9867 - loss: 0.04471701/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04471708/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04471716/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04461724/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04461731/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04461739/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9868 - loss: 0.04461747/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04461755/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04461763/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04461771/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451780/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451787/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451795/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451803/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451811/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451819/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451827/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451834/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04451841/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04441849/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04441856/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04441864/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04441872/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9868 - loss: 0.04441875/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9868 - loss: 0.0444 - val_accuracy: 0.9877 - val_loss: 0.0350
Epoch 3/5
   1/1875 ━━━━━━━━━━━━━━━━━━━━ 1:07 36ms/step - accuracy: 1.0000 - loss: 0.0061   7/1875 ━━━━━━━━━━━━━━━━━━━━ 16s 9ms/step - accuracy: 0.9994 - loss: 0.0101    14/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9981 - loss: 0.0112  21/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9973 - loss: 0.0126  28/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9966 - loss: 0.0134  36/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9960 - loss: 0.0141  44/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9956 - loss: 0.0150  52/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9954 - loss: 0.0157  61/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9951 - loss: 0.0167  69/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9950 - loss: 0.0174  77/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9949 - loss: 0.0179  85/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9948 - loss: 0.0182  93/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9948 - loss: 0.0185 101/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9948 - loss: 0.0188 110/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9947 - loss: 0.0192 118/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0196 126/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0200 134/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0202 141/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0204 149/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0205 156/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9945 - loss: 0.0206 164/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9945 - loss: 0.0207 171/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9945 - loss: 0.0208 179/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9945 - loss: 0.0208 186/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9944 - loss: 0.0209 193/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9944 - loss: 0.0210 200/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9944 - loss: 0.0211 208/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9943 - loss: 0.0212 214/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9943 - loss: 0.0212 221/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9943 - loss: 0.0213 229/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9942 - loss: 0.0215 236/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9942 - loss: 0.0216 244/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9942 - loss: 0.0217 251/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9941 - loss: 0.0218 258/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9941 - loss: 0.0219 266/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9940 - loss: 0.0220 274/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9940 - loss: 0.0221 281/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9939 - loss: 0.0221 289/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9939 - loss: 0.0222 296/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9939 - loss: 0.0222 304/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9938 - loss: 0.0223 311/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9938 - loss: 0.0223 319/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9938 - loss: 0.0224 327/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9938 - loss: 0.0224 335/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9937 - loss: 0.0224 343/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9937 - loss: 0.0225 351/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9937 - loss: 0.0225 359/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9937 - loss: 0.0225 367/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9936 - loss: 0.0226 375/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9936 - loss: 0.0226 383/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9936 - loss: 0.0226 390/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9936 - loss: 0.0226 398/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9936 - loss: 0.0226 405/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9935 - loss: 0.0227 413/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9935 - loss: 0.0227 421/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9935 - loss: 0.0227 429/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9935 - loss: 0.0228 437/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9934 - loss: 0.0228 445/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9934 - loss: 0.0229 453/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9934 - loss: 0.0230 461/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9933 - loss: 0.0230 469/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9933 - loss: 0.0231  478/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9933 - loss: 0.0231 486/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9932 - loss: 0.0232 494/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9932 - loss: 0.0233 502/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9932 - loss: 0.0233 510/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9931 - loss: 0.0234 518/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9931 - loss: 0.0234 526/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9931 - loss: 0.0235 534/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9930 - loss: 0.0236 541/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9930 - loss: 0.0236 548/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9930 - loss: 0.0237 555/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9930 - loss: 0.0237 563/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9929 - loss: 0.0238 570/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9929 - loss: 0.0239 578/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9929 - loss: 0.0239 586/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9928 - loss: 0.0240 594/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9928 - loss: 0.0241 602/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9928 - loss: 0.0242 610/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9927 - loss: 0.0242 618/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9927 - loss: 0.0243 626/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9927 - loss: 0.0243 634/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9927 - loss: 0.0244 642/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9926 - loss: 0.0244 650/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9926 - loss: 0.0245 658/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9926 - loss: 0.0245 665/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9926 - loss: 0.0246 674/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9926 - loss: 0.0246 682/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9925 - loss: 0.0246 690/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9925 - loss: 0.0247 697/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9925 - loss: 0.0247 705/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9925 - loss: 0.0247 714/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9925 - loss: 0.0248 722/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9924 - loss: 0.0248 730/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9924 - loss: 0.0249 738/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0249 747/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0249 754/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0249 761/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0250 768/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0250 776/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9924 - loss: 0.0250 783/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0250 790/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 798/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 805/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 812/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 819/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 826/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0251 834/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0252 842/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9923 - loss: 0.0252 850/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9922 - loss: 0.0252 858/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9922 - loss: 0.0252 865/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9922 - loss: 0.0252 873/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9922 - loss: 0.0253 881/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0253 889/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0253 898/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0253 905/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0253 913/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0253 921/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0254 929/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0254 937/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9922 - loss: 0.0254 945/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0254 953/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0254 961/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0254 969/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0254 977/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0254 984/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.0255 993/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.02551000/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.02551008/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9921 - loss: 0.02551016/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9921 - loss: 0.02551024/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9921 - loss: 0.02551032/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9921 - loss: 0.02551039/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9921 - loss: 0.02551046/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9921 - loss: 0.02561054/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561062/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561071/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561078/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561086/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561094/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02561102/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571110/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571117/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571125/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571132/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571141/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02571149/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9920 - loss: 0.02581157/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581165/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581172/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581180/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581187/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581195/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02581203/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591211/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591219/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591227/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591235/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591243/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02591251/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02601259/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02601267/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9919 - loss: 0.02601275/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9918 - loss: 0.02601283/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9918 - loss: 0.02601291/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9918 - loss: 0.02601299/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02601307/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02601315/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611323/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611331/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611339/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611347/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611355/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611363/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611371/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611379/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02611387/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621395/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621403/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621411/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621419/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621427/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621435/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9918 - loss: 0.02621443/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9918 - loss: 0.02621450/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9918 - loss: 0.02621457/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9918 - loss: 0.02621465/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02621473/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02621480/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631488/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631496/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631504/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631512/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631520/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631528/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631536/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631544/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631551/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02631559/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02641567/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02641574/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02641582/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9917 - loss: 0.02641590/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02641597/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02641605/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02641614/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02641622/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02641630/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02651638/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02651647/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9917 - loss: 0.02651655/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651663/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651671/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651679/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651687/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651695/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651703/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02651711/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02661719/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02661727/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9916 - loss: 0.02661735/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661744/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661752/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661760/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661768/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661776/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661784/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661792/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02661800/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671808/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671816/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671824/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671833/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671841/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671849/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671857/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671865/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9916 - loss: 0.02671873/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9915 - loss: 0.02671875/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 7ms/step - accuracy: 0.9915 - loss: 0.0267 - val_accuracy: 0.9890 - val_loss: 0.0314
Epoch 4/5
   1/1875 ━━━━━━━━━━━━━━━━━━━━ 1:17 41ms/step - accuracy: 1.0000 - loss: 0.0110   8/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9906 - loss: 0.0285    14/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9899 - loss: 0.0278  21/1875 ━━━━━━━━━━━━━━━━━━━━ 15s 8ms/step - accuracy: 0.9903 - loss: 0.0268  28/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9909 - loss: 0.0261  36/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 0.9917 - loss: 0.0252  45/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9923 - loss: 0.0240  52/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9926 - loss: 0.0231  60/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9930 - loss: 0.0223  68/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9932 - loss: 0.0218  76/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9933 - loss: 0.0215  85/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9934 - loss: 0.0214  93/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9934 - loss: 0.0213 101/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9935 - loss: 0.0211 108/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9936 - loss: 0.0209 114/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9937 - loss: 0.0207 120/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9938 - loss: 0.0205 126/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9939 - loss: 0.0203 132/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9940 - loss: 0.0201 138/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9940 - loss: 0.0199 144/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9941 - loss: 0.0197 151/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9942 - loss: 0.0195 158/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9942 - loss: 0.0193 165/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 8ms/step - accuracy: 0.9943 - loss: 0.0191 173/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9943 - loss: 0.0189 181/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9944 - loss: 0.0187 190/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9944 - loss: 0.0186 198/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 8ms/step - accuracy: 0.9945 - loss: 0.0184 206/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9945 - loss: 0.0183 214/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0182 221/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0181 228/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9946 - loss: 0.0180 236/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9947 - loss: 0.0179 244/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9947 - loss: 0.0178 251/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9947 - loss: 0.0178 258/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9947 - loss: 0.0177 265/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9947 - loss: 0.0177 272/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9948 - loss: 0.0176 280/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9948 - loss: 0.0175 288/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9948 - loss: 0.0175 295/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9948 - loss: 0.0174 304/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0174 312/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0174 320/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 329/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 337/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 345/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 352/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 360/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9949 - loss: 0.0173 369/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 377/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 385/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 393/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0172 401/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 409/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 417/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 425/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 433/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 442/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 450/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 458/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 465/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 473/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9949 - loss: 0.0173 482/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9949 - loss: 0.0174  489/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9949 - loss: 0.0174 497/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9949 - loss: 0.0174 505/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0174 513/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0174 522/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0174 530/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 537/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 545/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 553/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 560/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 568/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0175 576/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0176 584/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0176 593/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9948 - loss: 0.0176 601/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 609/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 618/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 626/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 634/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 642/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 649/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 658/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 667/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 675/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 683/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 691/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 698/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 705/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0176 713/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 721/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9948 - loss: 0.0177 730/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9947 - loss: 0.0177 737/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 744/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 752/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 760/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 769/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 777/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 785/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 793/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 800/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 809/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 817/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 825/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0177 834/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9947 - loss: 0.0178 842/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9946 - loss: 0.0178 850/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9946 - loss: 0.0178 857/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9946 - loss: 0.0178 865/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9946 - loss: 0.0178 873/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0178 881/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0178 888/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0178 896/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0178 904/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0178 911/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0179 918/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0179 927/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9946 - loss: 0.0179 934/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0179 942/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0179 949/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0179 957/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0179 965/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0180 973/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0180 982/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0180 989/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.0180 997/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.01801005/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.01801013/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9945 - loss: 0.01801022/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9945 - loss: 0.01801029/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811037/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811045/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811053/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811060/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811068/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811075/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811083/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01811091/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01821099/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01821107/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01821115/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9944 - loss: 0.01821122/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9943 - loss: 0.01821130/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9943 - loss: 0.01821138/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9943 - loss: 0.01821145/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9943 - loss: 0.01831153/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9943 - loss: 0.01831160/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01831168/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01831176/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01831184/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01831192/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01831201/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01841210/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9943 - loss: 0.01841218/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841226/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841234/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841242/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841250/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841258/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01841266/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01851274/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01851282/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01851290/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9942 - loss: 0.01851298/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851306/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851314/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851322/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851330/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851338/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01851346/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9942 - loss: 0.01861354/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861362/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861370/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861377/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861385/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861393/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861401/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861409/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861418/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861425/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01861432/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01871440/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9941 - loss: 0.01871448/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871457/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871465/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871473/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871481/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871490/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871497/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9941 - loss: 0.01871505/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01871513/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01871521/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01871529/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01871537/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881545/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881553/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881561/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881569/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881576/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881584/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9940 - loss: 0.01881592/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881600/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881608/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881615/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881624/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881632/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881639/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01881647/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891655/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891662/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891669/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891677/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891685/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891693/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9940 - loss: 0.01891701/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9939 - loss: 0.01891709/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9939 - loss: 0.01891717/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9939 - loss: 0.01891724/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9939 - loss: 0.01891732/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01891740/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901747/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901754/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901761/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901768/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901775/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901783/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901790/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901797/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901805/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901812/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901819/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901826/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901834/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901841/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901848/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01901855/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01911863/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01911870/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9939 - loss: 0.01911875/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 7ms/step - accuracy: 0.9939 - loss: 0.0191 - val_accuracy: 0.9901 - val_loss: 0.0326
Epoch 5/5
   1/1875 ━━━━━━━━━━━━━━━━━━━━ 1:11 38ms/step - accuracy: 1.0000 - loss: 2.2931e-04   8/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 1.0000 - loss: 0.0022        15/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 8ms/step - accuracy: 1.0000 - loss: 0.0034  23/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9999 - loss: 0.0047  31/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9997 - loss: 0.0057  39/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9995 - loss: 0.0059  47/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9994 - loss: 0.0060  55/1875 ━━━━━━━━━━━━━━━━━━━━ 13s 7ms/step - accuracy: 0.9993 - loss: 0.0062  63/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9991 - loss: 0.0063  70/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9990 - loss: 0.0064  77/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9990 - loss: 0.0065  84/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9989 - loss: 0.0065  91/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9989 - loss: 0.0065  99/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9988 - loss: 0.0066 106/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9987 - loss: 0.0067 114/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9987 - loss: 0.0069 122/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9986 - loss: 0.0070 130/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9985 - loss: 0.0071 138/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9984 - loss: 0.0073 145/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9983 - loss: 0.0074 153/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9983 - loss: 0.0075 161/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9982 - loss: 0.0076 170/1875 ━━━━━━━━━━━━━━━━━━━━ 12s 7ms/step - accuracy: 0.9981 - loss: 0.0078 178/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9980 - loss: 0.0079 186/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9980 - loss: 0.0080 194/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9979 - loss: 0.0081 203/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9978 - loss: 0.0083 211/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9977 - loss: 0.0084 218/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9977 - loss: 0.0085 226/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9976 - loss: 0.0086 234/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9976 - loss: 0.0087 243/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9975 - loss: 0.0088 251/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9975 - loss: 0.0088 259/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9974 - loss: 0.0089 267/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9974 - loss: 0.0089 275/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9974 - loss: 0.0090 283/1875 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.9973 - loss: 0.0090 291/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9973 - loss: 0.0091 300/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9973 - loss: 0.0092 308/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9972 - loss: 0.0092 316/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9972 - loss: 0.0093 324/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9972 - loss: 0.0093 332/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9972 - loss: 0.0094 340/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9971 - loss: 0.0095 348/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9971 - loss: 0.0095 356/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9971 - loss: 0.0096 364/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9971 - loss: 0.0096 372/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0097 380/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0097 388/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0098 395/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0098 403/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0098 410/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0099 418/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9970 - loss: 0.0099 426/1875 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.9969 - loss: 0.0099 434/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9969 - loss: 0.0100  442/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9969 - loss: 0.0100 449/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9969 - loss: 0.0100 458/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9969 - loss: 0.0101 466/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0101 474/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0102 483/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0102 491/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0102 499/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0103 507/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0103 514/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0103 522/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0104 530/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9968 - loss: 0.0104 537/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9967 - loss: 0.0104 545/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9967 - loss: 0.0104 553/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9967 - loss: 0.0105 561/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9967 - loss: 0.0105 569/1875 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.9967 - loss: 0.0105 577/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0105 584/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0105 592/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0106 599/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0106 606/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0106 614/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0106 621/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0106 628/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0107 636/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9967 - loss: 0.0107 643/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0107 650/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0107 658/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0107 665/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0108 672/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0108 680/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0108 688/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0108 695/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0109 703/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0109 711/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0109 720/1875 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.9966 - loss: 0.0110 728/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9966 - loss: 0.0110 736/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0110 744/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0110 752/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0111 760/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0111 768/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0111 776/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0112 785/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0112 792/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0112 800/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0113 808/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0113 816/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9965 - loss: 0.0113 825/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0113 833/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0114 840/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0114 848/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0114 856/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0114 864/1875 ━━━━━━━━━━━━━━━━━━━━ 7s 7ms/step - accuracy: 0.9964 - loss: 0.0115 872/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0115 880/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0115 888/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0116 896/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0116 904/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0116 911/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9964 - loss: 0.0116 919/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0117 927/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0117 935/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0117 943/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0117 951/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0118 960/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0118 968/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0118 976/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0118 984/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.0118 992/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.01191000/1875 ━━━━━━━━━━━━━━━━━━━━ 6s 7ms/step - accuracy: 0.9963 - loss: 0.01191008/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01191016/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01191024/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01201033/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01201041/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01201048/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01201056/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01211064/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01211071/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01211079/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01211087/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9962 - loss: 0.01211095/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01221103/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01221111/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01221118/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01221127/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01221134/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01231142/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01231149/1875 ━━━━━━━━━━━━━━━━━━━━ 5s 7ms/step - accuracy: 0.9961 - loss: 0.01231157/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9961 - loss: 0.01231164/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9961 - loss: 0.01231173/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9961 - loss: 0.01231181/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9961 - loss: 0.01241188/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241195/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241202/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241209/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241217/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241224/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01241232/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01251240/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01251248/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01251256/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01251264/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01251272/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01261280/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9960 - loss: 0.01261288/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9959 - loss: 0.01261296/1875 ━━━━━━━━━━━━━━━━━━━━ 4s 7ms/step - accuracy: 0.9959 - loss: 0.01261304/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01261312/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271320/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271328/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271336/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271344/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271352/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01271359/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01281367/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01281375/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01281382/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01281389/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9959 - loss: 0.01281397/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01281405/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01291412/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01291420/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01291429/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01291437/1875 ━━━━━━━━━━━━━━━━━━━━ 3s 7ms/step - accuracy: 0.9958 - loss: 0.01291445/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01291453/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301461/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301469/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301477/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301485/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301493/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301501/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01301508/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01311516/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01311524/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01311532/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9958 - loss: 0.01311540/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01311548/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01311556/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01321564/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01321572/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01321580/1875 ━━━━━━━━━━━━━━━━━━━━ 2s 7ms/step - accuracy: 0.9957 - loss: 0.01321588/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01321596/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01321604/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01321611/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01321619/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331626/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331634/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331642/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331650/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331658/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331666/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331673/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01331681/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341689/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341697/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341704/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341712/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341720/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341726/1875 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.9957 - loss: 0.01341732/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9957 - loss: 0.01341739/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01341746/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01341754/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351762/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351770/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351778/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351785/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351792/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351799/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351806/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351814/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351822/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01351830/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361838/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361845/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361853/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361860/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361868/1875 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.9956 - loss: 0.01361875/1875 ━━━━━━━━━━━━━━━━━━━━ 14s 7ms/step - accuracy: 0.9956 - loss: 0.0136 - val_accuracy: 0.9922 - val_loss: 0.0269</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;keras.src.callbacks.history.History at 0x2017f5ba750&gt;</code></pre>
</div>
</div>
<p>Explanation: - <strong>Data Preprocessing</strong>: The MNIST dataset is loaded and normalized. - <strong>CNN Definition</strong>: Convolutional and pooling layers extract features. - <strong>Flattening</strong>: Feature maps are flattened into a 1D vector. - <strong>Fully Connected Layers</strong>: Used for final classification. - <strong>Model Compilation</strong>: Uses Adam optimizer and categorical cross-entropy loss. - <strong>Model Training</strong>: Trains the CNN for 5 epochs.</p>
</section>
</section>
<section id="summary-1" class="level3" data-number="15.4.4">
<h3 data-number="15.4.4" class="anchored" data-anchor-id="summary-1"><span class="header-section-number">15.4.4</span> Summary</h3>
<ul>
<li>CNNs follow a structured architecture: convolutional layers extract features, pooling layers reduce dimensions, and fully connected layers make final predictions.</li>
<li>Popular CNN architectures include LeNet, AlexNet, and ResNet.</li>
<li>Training involves forward propagation (feature extraction and predictions) and backpropagation (learning from errors).</li>
<li>Python and Keras make it easy to define and train CNNs.</li>
</ul>
</section>
</section>
<section id="cnn-optimization-and-techniques" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="cnn-optimization-and-techniques"><span class="header-section-number">15.5</span> CNN Optimization and Techniques</h2>
<p>CNNs can be optimized in several ways to improve performance, reduce overfitting, and generalize well to new data. This chapter explores key optimization techniques, including stride and padding, dropout and regularization, and data augmentation.</p>
<section id="learning-with-cnns-strides-padding-and-filter-sizes" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="learning-with-cnns-strides-padding-and-filter-sizes"><span class="header-section-number">15.5.1</span> Learning with CNNs: Strides, Padding, and Filter Sizes</h3>
<section id="strides" class="level4" data-number="15.5.1.1">
<h4 data-number="15.5.1.1" class="anchored" data-anchor-id="strides"><span class="header-section-number">15.5.1.1</span> Strides</h4>
<p>The stride determines how far the convolutional filter moves at each step across the image.</p>
<ul>
<li><strong>Stride of 1</strong>: Moves one pixel at a time → More detailed feature extraction.</li>
<li><strong>Stride of 2 or more</strong>: Moves multiple pixels → Reduces spatial size but loses detail.</li>
</ul>
<p><strong>Analogy</strong>:<br>
Think of stride like reading a book: - <strong>Stride of 1</strong> → Reading every word carefully. - <strong>Stride of 2</strong> → Skipping every other word for a faster but less detailed understanding.</p>
</section>
<section id="padding" class="level4" data-number="15.5.1.2">
<h4 data-number="15.5.1.2" class="anchored" data-anchor-id="padding"><span class="header-section-number">15.5.1.2</span> Padding</h4>
<p>Padding helps control the size of feature maps:</p>
<ul>
<li><strong>Valid Padding (“No Padding”)</strong>: Reduces the spatial dimensions → Can lose edge details.</li>
<li><strong>Same Padding (“Zero Padding”)</strong>: Keeps the same output size by adding extra pixels → Preserves border information.</li>
</ul>
</section>
<section id="example-visualizing-the-effect-of-stride-and-padding" class="level4" data-number="15.5.1.3">
<h4 data-number="15.5.1.3" class="anchored" data-anchor-id="example-visualizing-the-effect-of-stride-and-padding"><span class="header-section-number">15.5.1.3</span> Example: Visualizing the Effect of Stride and Padding</h4>
<div id="3863ee0d" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple 5x5 image</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> tf.constant([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>],</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>],</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                     [<span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>]], dtype<span class="op">=</span>tf.float32)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> tf.reshape(image, [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>])  <span class="co"># Reshape to 4D tensor (batch_size, height, width, channels)</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a simple 3x3 filter</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span> <span class="op">=</span> tf.constant([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>]], dtype<span class="op">=</span>tf.float32)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span> <span class="op">=</span> tf.reshape(<span class="bu">filter</span>, [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply convolution with different strides and padding</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>conv_valid <span class="op">=</span> tf.nn.conv2d(image, <span class="bu">filter</span>, strides<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], padding<span class="op">=</span><span class="st">'VALID'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>conv_same <span class="op">=</span> tf.nn.conv2d(image, <span class="bu">filter</span>, strides<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], padding<span class="op">=</span><span class="st">'SAME'</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Valid Padding:</span><span class="ch">\n</span><span class="st">"</span>, conv_valid.numpy().squeeze())</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Same Padding:</span><span class="ch">\n</span><span class="st">"</span>, conv_same.numpy().squeeze())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valid Padding:
 [[-6. -6. -6.]
 [-6. -6. -6.]
 [-6. -6. -6.]]
Same Padding:
 [[ -9.  -4.  -4.  -4.  13.]
 [-21.  -6.  -6.  -6.  27.]
 [-36.  -6.  -6.  -6.  42.]
 [-51.  -6.  -6.  -6.  57.]
 [-39.  -4.  -4.  -4.  43.]]</code></pre>
</div>
</div>
</section>
</section>
<section id="dropout-and-regularization" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="dropout-and-regularization"><span class="header-section-number">15.5.2</span> Dropout and Regularization</h3>
<section id="preventing-overfitting-with-dropout" class="level4" data-number="15.5.2.1">
<h4 data-number="15.5.2.1" class="anchored" data-anchor-id="preventing-overfitting-with-dropout"><span class="header-section-number">15.5.2.1</span> Preventing Overfitting with Dropout</h4>
<p>CNNs are prone to overfitting, meaning they perform well on training data but poorly on unseen data. Dropout is a technique where some neurons are randomly ignored during training, forcing the network to learn more generalized patterns.</p>
<p><strong>Analogy</strong>:<br>
Imagine a student who relies only on a single book for an exam. If that book is removed (dropout), they are forced to study multiple sources, leading to better learning.</p>
</section>
<section id="adding-dropout-in-a-cnn" class="level4" data-number="15.5.2.2">
<h4 data-number="15.5.2.2" class="anchored" data-anchor-id="adding-dropout-in-a-cnn"><span class="header-section-number">15.5.2.2</span> Adding Dropout in a CNN</h4>
<div id="518aea76" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dropout</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> tf.keras.Sequential([</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">1</span>)),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.25</span>),  <span class="co"># Dropout applied to prevent overfitting</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    Flatten(),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.5</span>),  <span class="co"># Increased dropout before final layers</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile the model</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential_3"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv2d_5 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │           <span style="color: #00af00; text-decoration-color: #00af00">320</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_5 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">13</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_6 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">11</span>, <span style="color: #00af00; text-decoration-color: #00af00">11</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)     │        <span style="color: #00af00; text-decoration-color: #00af00">18,496</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_6 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">5</span>, <span style="color: #00af00; text-decoration-color: #00af00">5</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)       │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ flatten_3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)             │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1600</span>)           │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_6 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)            │       <span style="color: #00af00; text-decoration-color: #00af00">204,928</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dropout</span>)             │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)            │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_7 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>)             │         <span style="color: #00af00; text-decoration-color: #00af00">1,290</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">225,034</span> (879.04 KB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">225,034</span> (879.04 KB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
</section>
</section>
<section id="data-augmentation-in-cnns" class="level3" data-number="15.5.3">
<h3 data-number="15.5.3" class="anchored" data-anchor-id="data-augmentation-in-cnns"><span class="header-section-number">15.5.3</span> Data Augmentation in CNNs</h3>
<p>Data augmentation artificially increases the size of a dataset by applying transformations such as rotation, flipping, scaling, and shifting to existing images.</p>
<section id="benefits-of-data-augmentation" class="level4" data-number="15.5.3.1">
<h4 data-number="15.5.3.1" class="anchored" data-anchor-id="benefits-of-data-augmentation"><span class="header-section-number">15.5.3.1</span> Benefits of Data Augmentation</h4>
<ul>
<li><strong>Prevents Overfitting</strong>: Introduces variability to the dataset.</li>
<li><strong>Improves Generalization</strong>: Makes CNNs robust to different orientations and distortions.</li>
<li><strong>Mimics Real-World Variations</strong>: Handles changes like lighting, rotations, and object distortions.</li>
</ul>
</section>
<section id="example-applying-data-augmentation-using-keras" class="level4" data-number="15.5.3.2">
<h4 data-number="15.5.3.2" class="anchored" data-anchor-id="example-applying-data-augmentation-using-keras"><span class="header-section-number">15.5.3.2</span> Example: Applying Data Augmentation using Keras</h4>
<div id="7382ca94" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define an image data generator with augmentation</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>datagen <span class="op">=</span> ImageDataGenerator(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    rotation_range<span class="op">=</span><span class="dv">30</span>,  <span class="co"># Random rotation</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    width_shift_range<span class="op">=</span><span class="fl">0.2</span>,  <span class="co"># Random horizontal shift</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    height_shift_range<span class="op">=</span><span class="fl">0.2</span>,  <span class="co"># Random vertical shift</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    horizontal_flip<span class="op">=</span><span class="va">True</span>,  <span class="co"># Random horizontal flipping</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    zoom_range<span class="op">=</span><span class="fl">0.2</span>  <span class="co"># Random zoom</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load a sample image</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>sample_image <span class="op">=</span> np.random.rand(<span class="dv">1</span>, <span class="dv">28</span>, <span class="dv">28</span>, <span class="dv">1</span>)  <span class="co"># Simulated grayscale image</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate augmented images</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>augmented_images <span class="op">=</span> [<span class="bu">next</span>(<span class="bu">iter</span>(datagen.flow(sample_image, batch_size<span class="op">=</span><span class="dv">1</span>)))[<span class="dv">0</span>] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)]</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the augmented images</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span>))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> img, ax <span class="kw">in</span> <span class="bu">zip</span>(augmented_images, axes):</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    ax.imshow(img.squeeze(), cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    ax.axis(<span class="st">'off'</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter13_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="real-world-applications-of-cnns" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="real-world-applications-of-cnns"><span class="header-section-number">15.6</span> Real-World Applications of CNNs</h2>
<p>CNNs power some of the most advanced AI applications today, including image classification, object detection, and face recognition.</p>
<section id="image-classification" class="level3" data-number="15.6.1">
<h3 data-number="15.6.1" class="anchored" data-anchor-id="image-classification"><span class="header-section-number">15.6.1</span> Image Classification</h3>
<p>CNNs classify images into categories, e.g., detecting cats vs.&nbsp;dogs.</p>
<section id="example-using-a-pre-trained-cnn-for-image-classification" class="level4" data-number="15.6.1.1">
<h4 data-number="15.6.1.1" class="anchored" data-anchor-id="example-using-a-pre-trained-cnn-for-image-classification"><span class="header-section-number">15.6.1.1</span> Example: Using a Pre-Trained CNN for Image Classification</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.applications <span class="im">import</span> VGG16</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing <span class="im">import</span> image</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.applications.vgg16 <span class="im">import</span> preprocess_input, decode_predictions</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load a pre-trained VGG16 model</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> VGG16(weights<span class="op">=</span><span class="st">'imagenet'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and preprocess an image</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>img_path <span class="op">=</span> <span class="st">'example.jpg'</span>  <span class="co"># Replace with a real image path</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> image.load_img(img_path, target_size<span class="op">=</span>(<span class="dv">224</span>, <span class="dv">224</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>img_array <span class="op">=</span> image.img_to_array(img)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>img_array <span class="op">=</span> np.expand_dims(img_array, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>img_array <span class="op">=</span> preprocess_input(img_array)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the class</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> model.predict(img_array)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Predicted:"</span>, decode_predictions(preds, top<span class="op">=</span><span class="dv">3</span>)[<span class="dv">0</span>])  <span class="co"># Show top 3 predictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="object-detection" class="level3" data-number="15.6.2">
<h3 data-number="15.6.2" class="anchored" data-anchor-id="object-detection"><span class="header-section-number">15.6.2</span> Object Detection</h3>
<p>CNN-based models like YOLO (You Only Look Once) and Faster R-CNN can detect multiple objects in an image. These models output bounding boxes around detected objects.</p>
</section>
<section id="example-applications" class="level3" data-number="15.6.3">
<h3 data-number="15.6.3" class="anchored" data-anchor-id="example-applications"><span class="header-section-number">15.6.3</span> Example Applications:</h3>
<ul>
<li><strong>Autonomous Vehicles</strong>: Detects pedestrians, traffic signs, and other cars.</li>
<li><strong>Medical Imaging</strong>: Identifies tumors in X-rays or MRI scans.</li>
<li><strong>Security Systems</strong>: Face recognition for access control.</li>
</ul>
</section>
</section>
<section id="conclusion-and-summary" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="conclusion-and-summary"><span class="header-section-number">15.7</span> Conclusion and Summary</h2>
<ul>
<li>Recap the main ideas of CNNs: Their architecture, functionality, and use cases.</li>
<li>The future of CNNs in computer vision.</li>
<li>Final thoughts: CNNs have revolutionized how machines process visual data.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter12.html" class="pagination-link" aria-label="Autoencoders">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Autoencoders</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>